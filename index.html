<!DOCTYPE html >
<html>
  <head>
      <meta charset="utf-8" />
      <title>mapboxgl.js + d3.js tutorial - 01</title>
      <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
      <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.0.0/mapbox-gl.css' rel='stylesheet' />
      <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v0.37.0/mapbox-gl.js"></script>
      <script src="polylabel.js"></script>
      <script src="jquery-3.4.1.min.js"></script>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.6/d3.min.js" charset="utf-8"></script>

      <style media="screen">
          body { margin:0; padding:0; }
          #map { position:absolute; top:0; bottom:0; width:100%; }

          svg {
            position: absolute;
            width: 100%;
            height: 100%;
          }
          path {
              fill: #e55e5e;
              stroke: #e55e5e;
              stroke-width: 2;
              fill-opacity: 0.6;
          }

          .marker {
            background-image: url('mapbox-icon.png');
            background-size: cover;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
        }

      </style>
      
  </head>
  <body>
    <div id="map">
    </div>
    <script>

        // Load Json
        // $.getJSON("Dublin_test.json", function(data) {
        //     console.log(data); // this will show the info it in firebug console
            
        //     const coordinates = data.features[0].geometry.coordinates[0];
        //     console.log(coordinates);
        //     let test = polylabel(coordinates, 1.0);
        //     console.log(test);
        // });

        // Set-up map
    	mapboxgl.accessToken = 'pk.eyJ1Ijoiam9yZGl0b3N0IiwiYSI6ImQtcVkyclEifQ.vwKrOGZoZSj3N-9MB6FF_A';
        var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/outdoors-v9',
            //style: 'mapbox://styles/mapbox/light-v10',
            zoom: 16,
            center: [-6.256779999993682, 53.34395399102701]
            //pitch: 40
        });

        //Map is loaded
        map.on('load', function () {
            
            // Add GeoJSON source from GeoJSON file
            map.addSource("smallArea", {
                "type": "geojson",
                "data": "boundaries.json"
            });

            // Add GeoJSON source from GeoJSON file
            map.addSource("smallAreaData", {
                "type": "geojson",
                "data": "final_test_data.json"
            });
            
            // Add layer with boundaries
            map.addLayer({
                "id": "smallAreaLayer",
                "type": "line",
                "source": "smallArea",
                "paint": {
                    'line-width': 3,
                    'line-color': 'rgba(200, 100, 240, 0.4)',
                }
            });

            // Add layer with data
            map.addLayer({
                "id": "smallAreaDataLayer",
                "type": "symbol",
                "source": "smallArea",
                "paint": {
                    
                }
            });

        });


        // map.on('render', function() {
        
        //     $.getJSON("Dublin_test.json", function(data) {
                
        //         // const coordinates = data.features[0].geometry.coordinates[0];
        //         // console.log(coordinates);
        //         // let test = polylabel(coordinates, 1.0);
        //         // console.log(test);
                
        //         data.features.forEach(function(marker) {

        //             const coord = marker.geometry.coordinates[0];
        //             let center = polylabel(coord, 1.0);

        //             // create a HTML element for each feature
        //             var el = document.createElement('div');
        //             el.className = 'marker';

        //             // make a marker for each feature and add to the map
        //             new mapboxgl.Marker(el)
        //             .setLngLat(center)
        //             .addTo(map);
        //         });
        //     });
        // });

        //const coordinates = Dublin_test.json.features[0].geometry.coordinates;
        //let test = polylabel(coordinates, 1.0);
        //console.log(test);


        //icons test
        //add markers to map
        
        // geojson.features.forEach(function(marker) {

        // // create a HTML element for each feature
        // var el = document.createElement('div');
        // el.className = 'marker';

        // // make a marker for each feature and add to the map
        // new mapboxgl.Marker(el)
        // .setLngLat(marker.geometry.coordinates)
        // .addTo(map);
        // });

    </script>
  </body>
</html>